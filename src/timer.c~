#include"/home/farhan/Desktop/myOS_UZI/uzi2/header/timer.h"
#include"/home/farhan/Desktop/myOS_UZI/uzi2/header/stdtype.h"
#include"/home/farhan/Desktop/myOS_UZI/uzi2/header/isr.h"
#include"/home/farhan/Desktop/myOS_UZI/uzi2/header/stdgr.h"
#include"/home/farhan/Desktop/myOS_UZI/uzi2/header/timer.h"

uint32_t tick=0;

void timerCallback(register_t regs){
	tick++;
	puts("\nClock tick: ");
	puts_dec(tick);
}

void initTimer(uint32_ frequency){

	uint32_t divisor;
	registerInterruptHandler(IRQ0,&timerCallback);

	//send value to PIT, to slow it down
	divisor=1193180/frequency;

	outputPort8(0x43,0x36);	//send cmd byte

	//send divisor byte wise
	outputPort8(0x40,(uint8_t)divisor&0xff);
	outputPort8(0x40,(uint8_t)(divisor>>8)&0xff);
}
