[BITS 16]                       ; We need 16-bit intructions for Real mode

[ORG 0x7C00]                    ; The BIOS loads the boot sector into memory location 0x7C00

jmp load_kernel   	        ; Load the OS Kernel

%include"/home/farhan/Desktop/myOS_UZI/uzi2/boot/gdt.inc"
  
load_kernel:
        jmp enter_pm            ; Enter Protected Mode
        
print:
	lodsb				; load next byte from string from SI to AL
	or	al, al			; Does AL=0?
	jz	printDone		; Yep, null terminator found-bail out
	mov	ah, 0eh			; Nope-Print the character
	int	10h
	jmp	print			; Repeat until null terminator found
printDone:
	ret				; we are done, so return

enter_pm:        
	cli
	xor ax, ax  		; null segments
	mov ds, ax
	mov es, ax
	mov ax, 0x0000          ; stack begins at 0x9000-0xffff
	mov ss, ax
	mov sp, 0xffff
	
	sti
	mov  si,msgDebug
	call print
	cli
	hlt        
msgDebug	db	0x0D, 0x0A, "Debug: stage 2",0x00
